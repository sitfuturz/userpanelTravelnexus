<div class="suggestion-container">
  <!-- Header Section -->
  <div class="page-header">
    <h1 class="page-title">Feedback & Suggestions</h1>
    <div class="header-controls">
      <button class="add-btn" (click)="openSuggestionModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
        Submit Suggestion
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading suggestions...</p>
  </div>

  <!-- Suggestions List -->
  <div *ngIf="!isLoading" class="suggestions-content">
    <!-- Empty State -->
    <div *ngIf="suggestions.length === 0" class="empty-state">
      <div class="empty-icon">ðŸ’¡</div>
      <h3>No Suggestions Yet</h3>
      <p>You haven't submitted any suggestions yet. Click "Submit Suggestion" to get started.</p>
    </div>

    <!-- Suggestions Grid -->
    <div *ngIf="suggestions.length > 0" class="suggestions-grid">
      <div *ngFor="let suggestion of suggestions" class="suggestion-card" (click)="viewSuggestionDetails(suggestion)">
        <div class="card-header">
          <div class="suggestion-title">
            <h3>{{ suggestion.title }}</h3>
            <span class="suggestion-id">#{{ suggestion._id.slice(-6) }}</span>
          </div>
          <div class="suggestion-meta">
            <span class="category-badge" [ngClass]="getCategoryClass(suggestion.category)">
              {{ suggestion.category | titlecase }}
            </span>
            <span class="status-badge" [ngClass]="getStatusClass(suggestion.status)">
              {{ suggestion.status | titlecase }}
            </span>
          </div>
        </div>
        
        <div class="card-body">
          <p class="suggestion-details">{{ suggestion.details }}</p>
        </div>
        
        <div class="card-footer">
          <span class="suggestion-date">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
            {{ suggestion.createdAt | date:'MMM dd, yyyy' }}
          </span>
          <button class="view-details" (click)="viewSuggestionDetails(suggestion); $event.stopPropagation()">
            View Details
          </button>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="suggestions.length > 0 && totalPages > 1" class="pagination-container">
      <div class="pagination">
        <button 
          class="pagination-btn" 
          [disabled]="!hasPrevPage"
          (click)="goToPage(currentPage - 1)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"/>
          </svg>
        </button>
        <span class="pagination-info">
          Page {{ currentPage }} of {{ totalPages }}
        </span>
        <button 
          class="pagination-btn" 
          [disabled]="!hasNextPage"
          (click)="goToPage(currentPage + 1)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9,18 15,12 9,6"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Submit Suggestion Modal -->
<div *ngIf="showSuggestionModal" class="modal-overlay" (click)="closeSuggestionModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Submit New Suggestion</h2>
      <button class="close-btn" (click)="closeSuggestionModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <form [formGroup]="suggestionForm" (ngSubmit)="onSubmitSuggestion()">
        
        <div class="form-section">
          <label class="form-label">
            Title <span class="required">*</span>
          </label>
          <input 
            type="text" 
            formControlName="title" 
            placeholder="Enter suggestion title"
            class="form-input"
            [class.error]="suggestionForm.get('title')?.invalid && suggestionForm.get('title')?.touched">
          <div *ngIf="suggestionForm.get('title')?.invalid && suggestionForm.get('title')?.touched" class="error-text">
            Title is required (minimum 3 characters)
          </div>
        </div>

        <div class="form-section">
          <label class="form-label">
            Category <span class="required">*</span>
          </label>
          <select 
            formControlName="category" 
            class="form-select"
            [class.error]="suggestionForm.get('category')?.invalid && suggestionForm.get('category')?.touched">
            <option value="">Select a category</option>
            <option value="general">General</option>
            <option value="technical">Technical</option>
            <option value="feature">Feature Request</option>
            <option value="improvement">Improvement</option>
            <option value="other">Other</option>
          </select>
          <div *ngIf="suggestionForm.get('category')?.invalid && suggestionForm.get('category')?.touched" class="error-text">
            Please select a category
          </div>
        </div>

        <div class="form-section">
          <label class="form-label">
            Details <span class="required">*</span>
          </label>
          <textarea 
            formControlName="details" 
            placeholder="Describe your suggestion in detail..."
            rows="5"
            class="form-textarea"
            [class.error]="suggestionForm.get('details')?.invalid && suggestionForm.get('details')?.touched">
          </textarea>
          <div *ngIf="suggestionForm.get('details')?.invalid && suggestionForm.get('details')?.touched" class="error-text">
            Details are required (minimum 10 characters)
          </div>
        </div>

      <div class="form-actions">
        <button type="button" class="btn-cancel" (click)="closeSuggestionModal()">
          Cancel
        </button>
        <button 
          type="submit" 
          class="btn-submit" 
          [disabled]="isSubmitting || suggestionForm.invalid">
          <span *ngIf="!isSubmitting">Submit Suggestion</span>
          <span *ngIf="isSubmitting">Submitting...</span>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Suggestion Details Modal -->
<div *ngIf="showDetailModal" class="modal-overlay" (click)="closeDetailModal()">
  <div class="modal-content details-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title-section">
        <h2>Suggestion Details</h2>
        <span class="status-badge" [ngClass]="getStatusClass(selectedSuggestion.status)" *ngIf="selectedSuggestion">
          {{ selectedSuggestion.status | titlecase }}
        </span>
      </div>
      <button class="close-btn" (click)="closeDetailModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div *ngIf="selectedSuggestion" class="modal-body">
      <div class="detail-section">
        <span class="detail-label">Title</span>
        <h3 class="detail-value">{{ selectedSuggestion.title }}</h3>
      </div>

      <div class="detail-section">
        <span class="detail-label">Category</span>
        <span class="category-badge" [ngClass]="getCategoryClass(selectedSuggestion.category)">
          {{ selectedSuggestion.category | titlecase }}
        </span>
      </div>


      <div class="detail-section">
        <span class="detail-label">Details</span>
        <p class="detail-value">{{ selectedSuggestion.details }}</p>
      </div>

      <div *ngIf="selectedSuggestion.adminResponse" class="detail-section admin-response-detail">
        <span class="detail-label">Admin Response</span>
        <p class="detail-value response-text">{{ selectedSuggestion.adminResponse }}</p>
      </div>

      <div class="detail-section">
        <span class="detail-label">Submitted On</span>
        <p class="detail-value">{{ selectedSuggestion.createdAt | date:'full' }}</p>
      </div>

      <div class="detail-section">
        <span class="detail-label">Last Updated</span>
        <p class="detail-value">{{ selectedSuggestion.updatedAt | date:'full' }}</p>
      </div>
    </div>
  </div>
</div>
